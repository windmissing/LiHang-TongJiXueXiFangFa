# 算法：用kd树的k近邻搜索

输出：  
已构造的kd树  
目标点x

输出：  
x的最近邻  

在kd树中找出包含目标点x的叶结点：从根结点出发，递归地向下访问kd树。若目标点x当前维的坐标小于切分点的坐标，则移动到左子节点，否则移动到右子节点。直至子结点为叶结点为止。  
以此结点为当前最近点  
递归地向上回退，在每个结点进行以下操作：  
a) 如果该结点保存的实例点比当前最近点距离目标点更近，则以该实例点为“当前最近点”。  
b) 当前最近点一定存在于该结点一个子结点对应的区域。检查该子结点的父结点的另一个子结点对应的区域是否有更近的点。具体地，检查另一个子结点对应的区域是否以目标点为球心、以目标点与“当前最近点”间的距离为半径的超球体相交。如果相交，可能在另一个子结点对应的区域内存在距目标点更近的点，移动到另一个子结点。接着，递归的进行最近邻搜索。如果不相交，向上回退。
当回退到根结点时搜索结束。最后的“当前最近点”即为x的最近邻点。

